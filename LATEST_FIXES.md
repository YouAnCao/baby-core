# Baby Core v1.1 - æœ€æ–°ä¿®å¤æ±‡æ€»

## ğŸ› ä¿®å¤çš„é—®é¢˜

### 1. âœ… æ—¥æœŸæ˜¾ç¤ºé—®é¢˜
**é—®é¢˜**: å‰ç«¯æ˜¾ç¤ºçš„æ—¥æœŸå°‘ä¸€å¤©ï¼ˆæ˜¾ç¤º27æ—¥ï¼Œå®é™…æ˜¯28æ—¥ï¼‰

**åŸå› **: ä½¿ç”¨`toISOString()`è¿”å›UTCæ—¶é—´ï¼Œåœ¨UTC+8æ—¶åŒºä¼šå°‘ä¸€å¤©

**è§£å†³**: 
```javascript
// é”™è¯¯ï¼š
date.toISOString().split('T')[0]  // è¿”å›UTCæ—¥æœŸ

// æ­£ç¡®ï¼š
const year = date.getFullYear()
const month = String(date.getMonth() + 1).padStart(2, '0')
const day = String(date.getDate()).padStart(2, '0')
return `${year}-${month}-${day}`  // è¿”å›æœ¬åœ°æ—¥æœŸ
```

**å½±å“æ–‡ä»¶**: `web/src/views/Tracking.vue`

---

### 2. âœ… æäº¤æ—¶æ—¥æœŸé”™è¯¯
**é—®é¢˜**: è™½ç„¶æŠ¬å¤´æ˜¾ç¤ºæ­£ç¡®æ—¥æœŸï¼Œä½†æäº¤è®°å½•æ—¶è¿˜æ˜¯æ˜¨å¤©çš„æ—¥æœŸ

**åŸå› **: æäº¤æ—¶æ²¡æœ‰ä½¿ç”¨çˆ¶ç»„ä»¶ä¼ å…¥çš„`currentDate`ï¼Œè€Œæ˜¯ç›´æ¥ç”¨`new Date()`

**è§£å†³**: 
- æ·»åŠ `getCurrentDateTime()`å‡½æ•°
- ä½¿ç”¨`props.currentDate`æ„å»ºæ­£ç¡®çš„æ—¥æœŸæ—¶é—´
- åŒ…å«æ­£ç¡®çš„æ—¶åŒºä¿¡æ¯ï¼ˆ+08:00ï¼‰

**å½±å“æ–‡ä»¶**: `web/src/components/QuickEntry.vue`

---

### 3. âœ… è®¡æ—¶å™¨æ¯å±å½’é›¶
**é—®é¢˜**: å¼€å§‹è®¡æ—¶åï¼Œæ‰‹æœºæ¯å±æˆ–åˆ‡æ¢åº”ç”¨ï¼Œå†è¿›å…¥æ—¶è®¡æ—¶å½’é›¶

**åŸå› **: è®¡æ—¶å™¨çŠ¶æ€åªä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œé¡µé¢å¤±å»ç„¦ç‚¹åçŠ¶æ€ä¸¢å¤±

**è§£å†³**: 
- ä½¿ç”¨`localStorage`æŒä¹…åŒ–è®¡æ—¶å™¨çŠ¶æ€
- ä¿å­˜**å¼€å§‹æ—¶é—´**è€Œéç´¯è®¡ç§’æ•°
- é¡µé¢æ¢å¤æ—¶æ ¹æ®å¼€å§‹æ—¶é—´é‡æ–°è®¡ç®—
- è‡ªåŠ¨æ¢å¤è®¡æ—¶å™¨ç•Œé¢å’Œè¿è¡ŒçŠ¶æ€

**å®ç°ç»†èŠ‚**:
```javascript
// ä¿å­˜åˆ°localStorage
{
  method: 'breast_left',
  startTime: '2025-10-28T04:30:15.123Z',
  targetSeconds: 300,
  notes: 'å¤‡æ³¨'
}

// æ¢å¤æ—¶é‡æ–°è®¡ç®—
const elapsedSeconds = Math.floor((now - startTime) / 1000)
```

**å½±å“æ–‡ä»¶**: `web/src/components/QuickEntry.vue`

---

## ğŸ¯ æµ‹è¯•åœºæ™¯

### åœºæ™¯1: æ—¥æœŸæ˜¾ç¤º
1. âœ… æ‰“å¼€åº”ç”¨ï¼ŒæŸ¥çœ‹é¡¶éƒ¨æ—¥æœŸæ˜¾ç¤º
2. âœ… åº”è¯¥æ˜¾ç¤ºä»Šå¤©çš„æ—¥æœŸï¼ˆ2025-10-28ï¼‰
3. âœ… ç‚¹å‡»å‰ååˆ‡æ¢æ—¥æœŸæŒ‰é’®ï¼Œæ—¥æœŸæ­£ç¡®å˜åŒ–

### åœºæ™¯2: æäº¤æ—¥æœŸ
1. âœ… åˆ‡æ¢åˆ°æ˜¨å¤©ï¼ˆ2025-10-27ï¼‰
2. âœ… åˆ›å»ºä¸€æ¡å–‚å…»è®°å½•
3. âœ… è®°å½•åº”è¯¥ä¿å­˜ä¸º 2025-10-27ï¼Œè€Œä¸æ˜¯ä»Šå¤©

### åœºæ™¯3: è®¡æ—¶å™¨æŒä¹…åŒ–
1. âœ… ç‚¹å‡»"æ¯ä¹³-å·¦"ï¼Œå¼€å§‹è®¡æ—¶
2. âœ… æ‰‹æœºæ¯å±æˆ–åˆ‡æ¢åˆ°å…¶ä»–åº”ç”¨
3. âœ… ç­‰å¾…1-2åˆ†é’Ÿ
4. âœ… è¿”å›åº”ç”¨ï¼Œè®¡æ—¶å™¨åº”è¯¥ç»§ç»­è¿è¡Œï¼Œæ—¶é—´æ­£ç¡®ç´¯è®¡
5. âœ… åˆ·æ–°é¡µé¢ï¼Œè®¡æ—¶å™¨ç•Œé¢è‡ªåŠ¨æ¢å¤å¹¶ç»§ç»­è¿è¡Œ
6. âœ… ç‚¹å‡»"ç»“æŸå¹¶ä¿å­˜"ï¼Œè®°å½•ä¿å­˜æˆåŠŸ
7. âœ… å†æ¬¡æ‰“å¼€"æ¯ä¹³-å·¦"ï¼Œè®¡æ—¶å™¨ä»0å¼€å§‹ï¼ˆå·²æ¸…é™¤æ—§çŠ¶æ€ï¼‰

---

## ğŸš€ éƒ¨ç½²åˆ°æœåŠ¡å™¨

```bash
# 1. åœæ­¢æœåŠ¡
docker-compose down

# 2. æ¸…ç©ºæ—§æ•°æ®åº“ï¼ˆå¯é€‰ï¼Œå¦‚æ— é‡è¦æ•°æ®ï¼‰
rm -rf data/

# 3. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 4. é‡æ–°éƒ¨ç½²
./deploy.sh
```

**æˆ–è€…ä¿ç•™æ•°æ®ï¼ˆå¯é€‰ï¼‰**:
```bash
# 1. å¤‡ä»½æ•°æ®åº“
docker-compose exec baby-core sqlite3 /app/data/baby_tracker.db ".dump" > backup.sql

# 2. éƒ¨ç½²æ–°ç‰ˆæœ¬
docker-compose down
rm data/baby_tracker.db
git pull origin main
./deploy.sh

# 3. æ¢å¤æ•°æ®
docker-compose exec -T baby-core sqlite3 /app/data/baby_tracker.db < backup.sql
```

---

## ğŸ“Š æ›´æ–°ç»Ÿè®¡

### æäº¤å†å²
```
db0f79b fix: ä¿®å¤æ—¥æœŸæäº¤å’Œè®¡æ—¶å™¨æŒä¹…åŒ–é—®é¢˜
a84b54a fix: ä¿®å¤å‰ç«¯æ—¥æœŸæ˜¾ç¤ºæ—¶åŒºé—®é¢˜
f1b3022 refactor: æ”¹ä¸ºè¦†ç›–æ›´æ–°æ–¹å¼ï¼Œç®€åŒ–éƒ¨ç½²
```

### ä¿®æ”¹çš„æ–‡ä»¶
- `web/src/views/Tracking.vue` - æ—¥æœŸæ˜¾ç¤ºä¿®å¤
- `web/src/components/QuickEntry.vue` - æ—¥æœŸæäº¤å’Œè®¡æ—¶å™¨æŒä¹…åŒ–
- `backend/dist/` - é‡æ–°æ„å»ºçš„å‰ç«¯èµ„æº

### ä»£ç å˜æ›´
- æ–°å¢ `getCurrentDateTime()` å‡½æ•°
- æ–°å¢ `saveTimerState()` å‡½æ•°
- æ–°å¢ `restoreTimerState()` å‡½æ•°
- ä¿®æ”¹ `formatDate()` å‡½æ•°
- ä¿®æ”¹ `startTimer()` å‡½æ•°
- ä¿®æ”¹ `stopTimer()` å‡½æ•°
- æ·»åŠ  `onMounted` ç”Ÿå‘½å‘¨æœŸé’©å­

---

## âœ¨ ç°åœ¨å¯ç”¨çš„åŠŸèƒ½

1. âœ… **è½¯åˆ é™¤åŠŸèƒ½** - åˆ é™¤è®°å½•åå¯æ¢å¤
2. âœ… **æ­£ç¡®çš„æ—¥æœŸæ˜¾ç¤º** - åŒ¹é…ç”¨æˆ·æœ¬åœ°æ—¶åŒº
3. âœ… **æ­£ç¡®çš„æ—¥æœŸæäº¤** - ä½¿ç”¨é€‰æ‹©çš„æ—¥æœŸ
4. âœ… **è®¡æ—¶å™¨æŒä¹…åŒ–** - æ¯å±/åˆ‡æ¢åº”ç”¨åç»§ç»­è®¡æ—¶
5. âœ… **Dockeræ—¶åŒºä¿®å¤** - å®¹å™¨ä½¿ç”¨Asia/Shanghai
6. âœ… **è®°å½•æ’åºä¼˜åŒ–** - æŒ‰æ—¶é—´è‡ªç„¶æ’åº
7. âœ… **ç±»å‹æ ‡ç­¾å¯è¯†åˆ«** - åˆ é™¤çŠ¶æ€ä¸‹ä¿æŒé¢œè‰²

---

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### localStorageç»“æ„
```javascript
// Key: 'feeding_timer_state'
{
  "method": "breast_left",
  "startTime": "2025-10-28T04:30:15.123Z",
  "targetSeconds": 300,
  "notes": "å¤‡æ³¨å†…å®¹"
}
```

### æ—¶é—´æ ¼å¼
```javascript
// æäº¤ç»™åç«¯çš„æ ¼å¼ï¼ˆåŒ…å«æ—¶åŒºï¼‰
"2025-10-28T16:30:45.123+08:00"

// æ˜¾ç¤ºç»™ç”¨æˆ·çš„æ ¼å¼
"2025-10-28"
```

### è®¡æ—¶å™¨æ¢å¤é€»è¾‘
1. é¡µé¢åŠ è½½æ—¶æ£€æŸ¥localStorage
2. å¦‚æœæœ‰ä¿å­˜çš„çŠ¶æ€ï¼Œè®¡ç®—å·²è¿è¡Œæ—¶é—´
3. æ¢å¤ç•Œé¢ï¼ˆæ‰“å¼€å¼¹çª—ï¼‰
4. é‡æ–°å¯åŠ¨è®¡æ—¶å™¨interval
5. æäº¤æˆåŠŸæˆ–å–æ¶ˆæ—¶æ¸…é™¤localStorage

---

**é¢„è®¡æµ‹è¯•æ—¶é—´**: 5åˆ†é’Ÿ  
**éƒ¨ç½²æ—¶é—´**: 5-10åˆ†é’Ÿ  
**é£é™©ç­‰çº§**: ä½ âœ…

ğŸ‰ **æ‰€æœ‰é—®é¢˜å·²ä¿®å¤ï¼Œå¯ä»¥éƒ¨ç½²ï¼**

