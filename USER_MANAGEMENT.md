# ç”¨æˆ·ç®¡ç†æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•ç®¡ç† Baby Core åº”ç”¨çš„ç”¨æˆ·è´¦æˆ·ã€‚

## ğŸ“‹ ç”¨æˆ·ç®¡ç†è„šæœ¬

### 1. åˆ›å»ºç”¨æˆ· - `create-user.sh` â­

åˆ›å»ºæ–°ç”¨æˆ·è´¦æˆ·ï¼Œæ”¯æŒæŒ‡å®šç”¨æˆ·åå’Œå¯†ç ã€‚

**ç”¨æ³•**:

```bash
# æ–¹å¼ 1: å‘½ä»¤è¡Œå‚æ•°
./create-user.sh <username> <password>

# æ–¹å¼ 2: åªæŒ‡å®šç”¨æˆ·åï¼Œå¯†ç äº¤äº’è¾“å…¥
./create-user.sh <username>

# æ–¹å¼ 3: å®Œå…¨äº¤äº’å¼
./create-user.sh
```

**ç¤ºä¾‹**:

```bash
# åˆ›å»ºç”¨æˆ· adminï¼Œå¯†ç  mypassword123
./create-user.sh admin mypassword123

# åˆ›å»ºç”¨æˆ· johnï¼Œå¯†ç ä¼šæç¤ºè¾“å…¥
./create-user.sh john

# äº¤äº’å¼åˆ›å»ºç”¨æˆ·
./create-user.sh
# ç„¶åè¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
```

**åŠŸèƒ½**:
- âœ… è‡ªåŠ¨ç”Ÿæˆ bcrypt å¯†ç å“ˆå¸Œ
- âœ… æ”¯æŒå‘½ä»¤è¡Œå‚æ•°å’Œäº¤äº’å¼è¾“å…¥
- âœ… å¦‚æœç”¨æˆ·å·²å­˜åœ¨ï¼Œä¼šæ›¿æ¢ï¼ˆæ›´æ–°ï¼‰
- âœ… è‡ªåŠ¨è®°å½•åˆ›å»º/æ›´æ–°æ—¶é—´
- âœ… éªŒè¯ç”¨æˆ·åˆ›å»ºæˆåŠŸ

---

### 2. åˆ—å‡ºç”¨æˆ· - `list-users.sh`

æ˜¾ç¤ºæ•°æ®åº“ä¸­æ‰€æœ‰ç”¨æˆ·çš„åˆ—è¡¨ã€‚

**ç”¨æ³•**:

```bash
./list-users.sh
```

**è¾“å‡ºç¤ºä¾‹**:

```
==========================================
Baby Core - ç”¨æˆ·åˆ—è¡¨
==========================================

æ•°æ®åº“ä¸­çš„ç”¨æˆ·:

id  username  created_at           updated_at
--  --------  -------------------  -------------------
1   admin     2025-10-28 03:15:22  2025-10-28 03:15:22
2   john      2025-10-28 03:20:45  2025-10-28 03:20:45
3   mary      2025-10-28 03:25:10  2025-10-28 03:25:10

==========================================
```

---

### 3. é‡ç½®å¯†ç  - `reset-password.sh`

é‡ç½®æŒ‡å®šç”¨æˆ·çš„å¯†ç ã€‚

**ç”¨æ³•**:

```bash
# æ–¹å¼ 1: å‘½ä»¤è¡ŒæŒ‡å®šæ–°å¯†ç 
./reset-password.sh <username> <new_password>

# æ–¹å¼ 2: äº¤äº’å¼è¾“å…¥æ–°å¯†ç ï¼ˆæ¨èï¼Œæ›´å®‰å…¨ï¼‰
./reset-password.sh <username>
```

**ç¤ºä¾‹**:

```bash
# é‡ç½® admin çš„å¯†ç ä¸º newpass123
./reset-password.sh admin newpass123

# äº¤äº’å¼é‡ç½®å¯†ç ï¼ˆä¼šæç¤ºè¾“å…¥ä¸¤æ¬¡æ–°å¯†ç ï¼‰
./reset-password.sh admin
```

**åŠŸèƒ½**:
- âœ… éªŒè¯ç”¨æˆ·æ˜¯å¦å­˜åœ¨
- âœ… äº¤äº’å¼è¾“å…¥æ—¶ä¼šè¦æ±‚ç¡®è®¤å¯†ç 
- âœ… è‡ªåŠ¨æ›´æ–° updated_at æ—¶é—´æˆ³
- âœ… ç”Ÿæˆæ–°çš„ bcrypt å“ˆå¸Œ

---

### 4. åˆ é™¤ç”¨æˆ· - `delete-user.sh`

åˆ é™¤æŒ‡å®šçš„ç”¨æˆ·è´¦æˆ·ã€‚

**ç”¨æ³•**:

```bash
./delete-user.sh <username>
```

**ç¤ºä¾‹**:

```bash
./delete-user.sh john
```

**äº¤äº’è¿‡ç¨‹**:

```
==========================================
Baby Core - åˆ é™¤ç”¨æˆ·
==========================================

è­¦å‘Š: å³å°†åˆ é™¤ç”¨æˆ· 'john'
ç¡®è®¤åˆ é™¤? (yes/no): yes

âœ“ ç”¨æˆ· 'john' å·²åˆ é™¤
```

**æ³¨æ„**:
- âš ï¸ åˆ é™¤æ“ä½œä¸å¯æ¢å¤
- âš ï¸ éœ€è¦è¾“å…¥ `yes` ç¡®è®¤åˆ é™¤
- âš ï¸ ä¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### é¦–æ¬¡éƒ¨ç½²ååˆ›å»ºç®¡ç†å‘˜

```bash
# æ–¹å¼ 1: ä½¿ç”¨é»˜è®¤ç”¨æˆ·è„šæœ¬
./init-user-simple.sh
# åˆ›å»º: admin / admin123

# æ–¹å¼ 2: ä½¿ç”¨è‡ªå®šä¹‰ç”¨æˆ·è„šæœ¬
./create-user.sh admin MySecurePassword123
```

### åˆ›å»ºå¤šä¸ªç”¨æˆ·

```bash
# ä¸ºå®¶äººåˆ›å»ºè´¦æˆ·
./create-user.sh dad password1
./create-user.sh mom password2
./create-user.sh grandma password3
```

### æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·

```bash
./list-users.sh
```

### é‡ç½®å¿˜è®°çš„å¯†ç 

```bash
# äº¤äº’å¼é‡ç½®ï¼ˆæ¨èï¼‰
./reset-password.sh admin

# æˆ–ç›´æ¥æŒ‡å®šæ–°å¯†ç 
./reset-password.sh admin NewPassword123
```

### åˆ é™¤ä¸éœ€è¦çš„ç”¨æˆ·

```bash
./delete-user.sh old_user
```

---

## ğŸ“– å®Œæ•´ä½¿ç”¨æµç¨‹ç¤ºä¾‹

### åœºæ™¯ 1: æ–°ç³»ç»Ÿè®¾ç½®

```bash
# 1. éƒ¨ç½²åº”ç”¨
./deploy.sh

# 2. åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·
./create-user.sh admin SecurePass123

# 3. åˆ›å»ºå®¶åº­æˆå‘˜è´¦æˆ·
./create-user.sh dad DadPass123
./create-user.sh mom MomPass123

# 4. æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·
./list-users.sh

# 5. è®¿é—®åº”ç”¨å¹¶ç™»å½•
# http://your-server-ip/baby-core
```

### åœºæ™¯ 2: å¯†ç ç®¡ç†

```bash
# ç”¨æˆ·å¿˜è®°å¯†ç 
./reset-password.sh john

# æˆ–ç®¡ç†å‘˜é‡ç½®å¯†ç 
./reset-password.sh john NewTempPassword123
```

### åœºæ™¯ 3: ç”¨æˆ·ç®¡ç†

```bash
# åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·
./list-users.sh

# åˆ é™¤ç¦»èŒæˆ–ä¸å†ä½¿ç”¨çš„è´¦æˆ·
./delete-user.sh old_account

# éªŒè¯åˆ é™¤
./list-users.sh
```

---

## ğŸ”’ å®‰å…¨å»ºè®®

### å¯†ç å®‰å…¨

1. **ä½¿ç”¨å¼ºå¯†ç **
   - è‡³å°‘ 8 ä¸ªå­—ç¬¦
   - åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦
   - é¿å…ä½¿ç”¨å¸¸è§å¯†ç 

2. **å®šæœŸæ›´æ¢å¯†ç **
   ```bash
   ./reset-password.sh username
   ```

3. **ä¸è¦åœ¨å‘½ä»¤è¡Œä¸­æ˜æ–‡è¾“å…¥å¯†ç **
   ```bash
   # âŒ ä¸æ¨èï¼ˆå¯†ç ä¼šç•™åœ¨ shell å†å²ä¸­ï¼‰
   ./create-user.sh admin password123
   
   # âœ… æ¨èï¼ˆäº¤äº’å¼è¾“å…¥ï¼‰
   ./create-user.sh admin
   ```

### ç”¨æˆ·ç®¡ç†

1. **åŠæ—¶åˆ é™¤ä¸ç”¨çš„è´¦æˆ·**
   ```bash
   ./delete-user.sh unused_user
   ```

2. **å®šæœŸå®¡æŸ¥ç”¨æˆ·åˆ—è¡¨**
   ```bash
   ./list-users.sh
   ```

3. **é¦–æ¬¡ç™»å½•åä¿®æ”¹é»˜è®¤å¯†ç **
   - å¦‚æœä½¿ç”¨äº† `init-user-simple.sh`ï¼Œè¯·ç«‹å³ä¿®æ”¹ admin/admin123

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### å®¹å™¨æœªè¿è¡Œ

**é”™è¯¯**:
```
é”™è¯¯: baby-core å®¹å™¨æœªè¿è¡Œ
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¯åŠ¨å®¹å™¨
docker-compose up -d

# éªŒè¯å®¹å™¨çŠ¶æ€
docker-compose ps
```

### å¯†ç å“ˆå¸Œç”Ÿæˆå¤±è´¥

**é”™è¯¯**:
```
é”™è¯¯: ç”Ÿæˆå¯†ç å“ˆå¸Œå¤±è´¥
```

**å¯èƒ½åŸå› **:
- å®¹å™¨å†…ç¼ºå°‘å¿…è¦çš„ Go ä¾èµ–
- å¯†ç åŒ…å«ç‰¹æ®Šå­—ç¬¦å¯¼è‡´ shell è§£æé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨äº¤äº’å¼è¾“å…¥ï¼ˆé¿å…ç‰¹æ®Šå­—ç¬¦é—®é¢˜ï¼‰
./create-user.sh username

# æˆ–æ£€æŸ¥å®¹å™¨æ—¥å¿—
docker-compose logs baby-core
```

### æ•°æ®åº“æƒé™é—®é¢˜

**é”™è¯¯**:
```
é”™è¯¯: æ’å…¥ç”¨æˆ·å¤±è´¥
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥æ•°æ®ç›®å½•æƒé™
ls -la data/

# ä¿®å¤æƒé™
chmod 755 data/
chmod 644 data/*.db

# é‡å¯å®¹å™¨
docker-compose restart baby-core
```

---

## ğŸ“Š æŠ€æœ¯ç»†èŠ‚

### å¯†ç å­˜å‚¨

- ä½¿ç”¨ **bcrypt** ç®—æ³•åŠ å¯†å¯†ç 
- Cost factor: **10**ï¼ˆé»˜è®¤ï¼‰
- æ¯ä¸ªå¯†ç ç”Ÿæˆå”¯ä¸€çš„ç›å€¼
- å¯†ç å“ˆå¸Œä¸å¯é€†

### æ•°æ®åº“ç»“æ„

```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT UNIQUE NOT NULL,
    password_hash TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### è„šæœ¬å·¥ä½œåŸç†

1. **create-user.sh**
   - åœ¨å®¹å™¨å†…åˆ›å»ºä¸´æ—¶ Go ç¨‹åº
   - ä½¿ç”¨ `golang.org/x/crypto/bcrypt` ç”Ÿæˆå“ˆå¸Œ
   - é€šè¿‡ `INSERT OR REPLACE` æ’å…¥/æ›´æ–°ç”¨æˆ·
   - æ¸…ç†ä¸´æ—¶æ–‡ä»¶

2. **list-users.sh**
   - ç›´æ¥æŸ¥è¯¢ SQLite æ•°æ®åº“
   - æ ¼å¼åŒ–è¾“å‡ºè¡¨æ ¼

3. **reset-password.sh**
   - æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨
   - ç”Ÿæˆæ–°å¯†ç å“ˆå¸Œ
   - ä½¿ç”¨ `UPDATE` æ›´æ–°å¯†ç å’Œæ—¶é—´æˆ³

4. **delete-user.sh**
   - ç¡®è®¤æ“ä½œ
   - ä½¿ç”¨ `DELETE` åˆ é™¤ç”¨æˆ·è®°å½•

---

## ğŸ¯ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# åˆ›å»ºç”¨æˆ·ï¼ˆäº¤äº’å¼ï¼‰
./create-user.sh

# åˆ›å»ºæŒ‡å®šç”¨æˆ·
./create-user.sh username password

# åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·
./list-users.sh

# é‡ç½®å¯†ç ï¼ˆäº¤äº’å¼ï¼‰
./reset-password.sh username

# åˆ é™¤ç”¨æˆ·
./delete-user.sh username

# åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜ï¼ˆadmin/admin123ï¼‰
./init-user-simple.sh
```

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¼€å§‹æŒ‡å—](./QUICKSTART_DOCKER.md)
- [å®Œæ•´éƒ¨ç½²æ–‡æ¡£](./DEPLOYMENT_DOCKER.md)
- [æœåŠ¡å™¨é…ç½®æŒ‡å—](./SERVER_SETUP.md)
- [éƒ¨ç½²å…¥å£æ–‡æ¡£](./DEPLOY_README.md)

---

**æ›´æ–°æ—¥æœŸ**: 2025-10-28  
**ç‰ˆæœ¬**: 1.0.0

